!function(t,i){function s(){return!!a.createElement("canvas").getContext}function o(i,s){this.element=i,this.options=t.extend({},r,s,t(this.element).data()),this._defaults=r,this._name=e,this.init()}function n(t){return Math.PI/180*t-Math.PI/180*90}var e="cirque",a=i.document,r={value:0,radius:60,total:100,label:"percent",lineWidth:10,arcColor:"#0066CC",trackColor:"#EEEEEE",trackFill:"transparent",animate:!0,speed:20};o.prototype.init=function(){if(!s())return!1;var t,i,o,e;t=this.makeContainer(),i=this.makeCanvas(),o=this.makeTrack(),this.arcContext=i.get(0).getContext("2d"),this.trackContext=o.get(0).getContext("2d"),this.drawTrack(),e=this.makeValue(),this.options.animate?this.start():this.drawArc(n(this.options.value/this.options.total*360))},o.prototype.start=function(){var t=1,i=this,s=this.options.value/this.options.total,o=s/50,e=setInterval(function(){t>48&&clearInterval(e),t++,endAngle=n(o*t*360),i.drawArc(endAngle)},i.options.speed)},o.prototype.drawArc=function(t){this.arcContext.clearRect(0,0,2*this.options.radius,2*this.options.radius),this.arcContext.beginPath(),this.arcContext.strokeStyle=this.options.arcColor,this.arcContext.arc(this.options.radius,this.options.radius,this.options.radius-this.options.lineWidth,n(0),t),this.arcContext.lineWidth=this.options.lineWidth,this.arcContext.stroke()},t.fn.cirque=function(i){return this.each(function(){t.data(this,"plugin_"+e)||t.data(this,"plugin_"+e,new o(this,i))})},o.prototype.drawTrack=function(){this.trackContext.beginPath(),this.trackContext.strokeStyle=this.options.trackColor,this.trackContext.arc(this.options.radius,this.options.radius,this.options.radius-this.options.lineWidth,0,360),this.trackContext.lineWidth=this.options.lineWidth,this.trackContext.fillStyle=this.options.trackFill,this.trackContext.fill(),this.trackContext.stroke()},o.prototype.makeValue=function(){var i,s,o;return"percent"==this.options.label?(i=Math.round(this.options.value/this.options.total*100*Math.pow(10,2))/Math.pow(10,2),s=i+"%",o="percent"):(i=this.options.value,s=i+"/"+this.options.total,o="ratio"),t("<div>",{"class":"cirque-label"}).appendTo(this.element).html(s).addClass(o).css({width:2*this.options.radius}).css({height:2*this.options.radius}).css({"line-height":2*this.options.radius+"px"})},o.prototype.makeCanvas=function(){return t("<canvas/>",{}).appendTo(this.element).attr("width",2*this.options.radius).attr("height",2*this.options.radius).addClass("cirque-fill")},o.prototype.makeTrack=function(){return t("<canvas/>",{}).appendTo(this.element).attr("width",2*this.options.radius).attr("height",2*this.options.radius).addClass("cirque-track")},o.prototype.makeContainer=function(){return t(this.element).addClass("cirque-container").css({width:2*this.options.radius}).css({height:2*this.options.radius})}}(jQuery,window);